<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Planet Microbe Search Demo</title>

    <!-- Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <!-- Elm -->
    <script src="./elm.js"></script>
  </head>
  <body>
    <div id="main"></div>
    <script>
var app = Elm.Main.init({
  node: document.getElementById('main')
});

app.ports.loadMap.subscribe(function(model) {
    var mapDiv = document.getElementsByTagName('gmap')[0]; // TODO add support for more than one map in a page
    if (!mapDiv) {
      throw("Error: map div not found");
    }

    var myLatlng = new google.maps.LatLng(model.lat, model.lng);
    var mapOptions = {
        zoom: 2,
        center: myLatlng
    };

    var gmap = new google.maps.Map(mapDiv, mapOptions);

    let circle = {
      "type":"Polygon",
      "coordinates":
        [ [ [-157.990550064683,22.7671303724537],[-157.990105784494,22.7671231022872],[-157.989661980051,22.7671012995731],[-157.989219126592,22.767064987658],[-157.988777698334,22.7670142054258],[-157.988338167971,22.7669490072553],[-157.987901006162,22.7668694629623],[-157.987466681031,22.766775657725],[-157.987035657665,22.7666676919922],[-157.986608397614,22.7665456813764],[-157.986185358398,22.7664097565296],[-157.98576699302,22.7662600630036],[-157.985353749474,22.7660967610938],[-157.984946070273,22.7659200256682],[-157.98454439197,22.7657300459794],[-157.984149144691,22.7655270254624],[-157.983760751677,22.7653111815166],[-157.983379628831,22.7650827452733],[-157.983006184266,22.7648419613476],[-157.982640817877,22.764589087577],[-157.982283920908,22.764324394745],[-157.981935875533,22.7640481662914],[-157.981597054448,22.7637606980085],[-157.98126782047,22.7634622977246],[-157.980948526151,22.7631532849742],[-157.980639513401,22.7628339906558],[-157.980341113117,22.7625047566777],[-157.980053644834,22.7621659355921],[-157.97977741638,22.761817890217],[-157.979512723549,22.7614609932481],[-157.979259849778,22.7610956268596],[-157.979019065852,22.760722182295],[-157.978790629609,22.7603410594481],[-157.978574785663,22.7599526664347],[-157.978371765146,22.7595574191559],[-157.978181785457,22.7591557408524],[-157.978005050032,22.7587480616512],[-157.977841748122,22.7583348181056],[-157.977692054596,22.757916452727],[-157.977556129749,22.7574934135117],[-157.977434119133,22.7570661534605],[-157.9773261534,22.7566351300942],[-157.977232348163,22.7562008049635],[-157.97715280387,22.7557636431546],[-157.9770876057,22.7553241127913],[-157.977036823468,22.7548826845337],[-157.977000511552,22.7544398310742],[-157.976978708838,22.7539960266315],[-157.976971438672,22.7535517464424],[-157.976978708838,22.7531074662534],[-157.977000511552,22.7526636618107],[-157.977036823468,22.7522208083512],[-157.9770876057,22.7517793800936],[-157.97715280387,22.7513398497303],[-157.977232348163,22.7509026879214],[-157.9773261534,22.7504683627907],[-157.977434119133,22.7500373394244],[-157.977556129749,22.7496100793732],[-157.977692054596,22.7491870401578],[-157.977841748122,22.7487686747793],[-157.978005050032,22.7483554312337],[-157.978181785457,22.7479477520325],[-157.978371765146,22.747546073729],[-157.978574785663,22.7471508264502],[-157.978790629609,22.7467624334368],[-157.979019065852,22.7463813105899],[-157.979259849778,22.7460078660253],[-157.979512723549,22.7456424996368],[-157.97977741638,22.7452856026679],[-157.980053644834,22.7449375572928],[-157.980341113117,22.7445987362071],[-157.980639513401,22.7442695022291],[-157.980948526151,22.7439502079107],[-157.98126782047,22.7436411951603],[-157.981597054448,22.7433427948763],[-157.981935875533,22.7430553265935],[-157.982283920908,22.7427790981399],[-157.982640817877,22.7425144053079],[-157.983006184266,22.7422615315373],[-157.983379628831,22.7420207476116],[-157.983760751677,22.7417923113682],[-157.984149144691,22.7415764674225],[-157.98454439197,22.7413734469055],[-157.984946070273,22.7411834672167],[-157.985353749474,22.7410067317911],[-157.98576699302,22.7408434298813],[-157.986185358398,22.7406937363553],[-157.986608397614,22.7405578115085],[-157.987035657665,22.7404358008927],[-157.987466681031,22.7403278351599],[-157.987901006162,22.7402340299225],[-157.988338167971,22.7401544856296],[-157.988777698334,22.7400892874591],[-157.989219126592,22.7400385052269],[-157.989661980051,22.7400021933118],[-157.990105784494,22.7399803905976],[-157.990550064683,22.7399731204312],[-157.990994344872,22.7399803905976],[-157.991438149315,22.7400021933118],[-157.991881002774,22.7400385052269],[-157.992322431032,22.7400892874591],[-157.992761961395,22.7401544856296],[-157.993199123204,22.7402340299225],[-157.993633448335,22.7403278351599],[-157.994064471701,22.7404358008927],[-157.994491731752,22.7405578115085],[-157.994914770968,22.7406937363553],[-157.995333136346,22.7408434298813],[-157.995746379892,22.7410067317911],[-157.996154059093,22.7411834672167],[-157.996555737397,22.7413734469055],[-157.996950984675,22.7415764674225],[-157.997339377689,22.7417923113682],[-157.997720500536,22.7420207476116],[-157.9980939451,22.7422615315373],[-157.998459311489,22.7425144053079],[-157.998816208458,22.7427790981399],[-157.999164253833,22.7430553265935],[-157.999503074918,22.7433427948763],[-157.999832308896,22.7436411951603],[-158.000151603215,22.7439502079107],[-158.000460615965,22.7442695022291],[-158.000759016249,22.7445987362071],[-158.001046484532,22.7449375572928],[-158.001322712986,22.7452856026679],[-158.001587405818,22.7456424996368],[-158.001840279588,22.7460078660253],[-158.002081063514,22.7463813105899],[-158.002309499757,22.7467624334368],[-158.002525343703,22.7471508264502],[-158.00272836422,22.747546073729],[-158.002918343909,22.7479477520325],[-158.003095079334,22.7483554312337],[-158.003258381244,22.7487686747793],[-158.00340807477,22.7491870401578],[-158.003543999617,22.7496100793732],[-158.003666010233,22.7500373394244],[-158.003773975966,22.7504683627907],[-158.003867781203,22.7509026879214],[-158.003947325496,22.7513398497303],[-158.004012523666,22.7517793800936],[-158.004063305899,22.7522208083512],[-158.004099617814,22.7526636618107],[-158.004121420528,22.7531074662534],[-158.004128690694,22.7535517464424],[-158.004121420528,22.7539960266315],[-158.004099617814,22.7544398310742],[-158.004063305899,22.7548826845337],[-158.004012523666,22.7553241127913],[-158.003947325496,22.7557636431546],[-158.003867781203,22.7562008049635],[-158.003773975966,22.7566351300942],[-158.003666010233,22.7570661534605],[-158.003543999617,22.7574934135117],[-158.00340807477,22.757916452727],[-158.003258381244,22.7583348181056],[-158.003095079334,22.7587480616512],[-158.002918343909,22.7591557408524],[-158.00272836422,22.7595574191559],[-158.002525343703,22.7599526664347],[-158.002309499757,22.7603410594481],[-158.002081063514,22.760722182295],[-158.001840279588,22.7610956268596],[-158.001587405818,22.7614609932481],[-158.001322712986,22.761817890217],[-158.001046484532,22.7621659355921],[-158.000759016249,22.7625047566777],[-158.000460615965,22.7628339906558],[-158.000151603215,22.7631532849742],[-157.999832308896,22.7634622977246],[-157.999503074918,22.7637606980085],[-157.999164253833,22.7640481662914],[-157.998816208458,22.764324394745],[-157.998459311489,22.764589087577],[-157.9980939451,22.7648419613476],[-157.997720500536,22.7650827452733],[-157.997339377689,22.7653111815166],[-157.996950984675,22.7655270254624],[-157.996555737397,22.7657300459794],[-157.996154059093,22.7659200256682],[-157.995746379892,22.7660967610938],[-157.995333136346,22.7662600630036],[-157.994914770968,22.7664097565296],[-157.994491731752,22.7665456813764],[-157.994064471701,22.7666676919922],[-157.993633448335,22.766775657725],[-157.993199123204,22.7668694629623],[-157.992761961395,22.7669490072553],[-157.992322431032,22.7670142054258],[-157.991881002774,22.767064987658],[-157.991438149315,22.7671012995731],[-157.990994344872,22.7671231022872],[-157.990550064683,22.7671303724537] ] ]
    };
    let centroid = {"type":"Point","coordinates":[-157.995680851064,22.7520276595745]};

    gmap.data.addGeoJson({ type: "Feature", id: 1, "geometry": circle });

    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(centroid.coordinates[1],centroid.coordinates[0]),
        map: gmap,
        label: "47"
    });
});

/*app.ports.setCenter.subscribe(function(model) {
    var myLatlng = new google.maps.LatLng(model.center.lat, model.center.lng);
    model.gmap.setCenter(myLatlng);
});*/
    </script>

    <!-- GoogleMaps -->
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCIQ7aSxFXmmx8oEAZ2KNPOyGiSkuj9hdA" type="text/javascript"></script> <!-- FIXME -->
  </body>
</html>
